<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inserisci Nuovo Servizio</title>
    <link rel="stylesheet" href="/css/index.css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
       
     
        .card-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .card {
            flex: 1 1 calc(33.333% - 1rem);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .card-body {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .btn-edit {
            align-self: flex-end;
        }
      
    </style>
</head>
<body>

<!-- Header -->
	<nav th:replace="fragments/base.html :: nav"></nav>
    
   <div class="container main-content mt-2 mb-3">
		<div class="row justify-content-center">
			<div class="col-md-8">
				<div class="highlight">
					<h2 class="text-center text-primary display-4 bold"
						th:text=" 'Benvenuto'+' '+${user.nome} + ' ' + ${user.cognome}">Benvenuto valerio</h2>
					<p class="text-center lead">Gestisci le prenotazioni con te e i servizi da questa pagina.</p>
				</div>
			</div>
		</div>
	</div>

	<div class="container mt-5">
		<h2 class="mb-4">Le tue Prenotazioni</h2>
		<table class="table table-bordered table-custom-header">
			<thead class="bg-primary text-white">
				<tr>
					<th scope="col">Giorno</th>
					<th scope="col">Ora</th>
					<th scope="col">Servizio</th>
					<th scope="col">Cliente</th>
					<th scope="col">Azione</th>
				</tr>
			</thead>
			<tbody>
				<!-- Esempio di riga di prenotazione -->
				<tr th:each="pren: ${prenotazioni}">
					<td th:text="${pren.orario.toLocalDate()}" ></td>
					<td th:text="${pren.orario.toLocalTime()}"></td>
					<td th:text="${pren.servizio.nome}"></td>
					<td th:text="${pren.cliente.nome} + ' ' + ${pren.cliente.cognome}"></td>
					<td>
						<button type="button" class="btn btn-danger btn-sm">Disdici</button>
					</td>
				</tr>
				<!-- Altre righe possono essere aggiunte dinamicamente -->
			</tbody>
		</table>
	</div>
	
    <div class="container mt-5">
        <h2 class="mb-4 ">Inserisci Nuovo Servizio</h2>
        
        <form th:action="@{/newServizio}" method="post">
        
            <div class="mb-4">
                <label for="serviceName">Nome del Servizio</label>
                <input type="text" class="form-control" id="serviceName" placeholder="Nome del servizio" th:field="${servizio.nome}" required>
            </div>
            <div class="mb-4">
                <label for="serviceDescription">Descrizione</label>
                <textarea class="form-control" id="serviceDescription" rows="3" placeholder="Descrizione del servizio" th:field="${servizio.descrizione}" name="descrizione" required></textarea>
            </div>
            <div class="mb-4">
                <label for="servicePrice">Prezzo</label>
                <input type="number" class="form-control" id="servicePrice" placeholder="Prezzo del servizio" step="0.01" th:field="${servizio.prezzo}" required>
            </div>
            <button type="submit" class="btn btn-primary btn-block">Aggiungi Servizio</button>
        </form>
    </div>
    <div class="container mt-5">
        <h2 class="mb-4 ">Servizi Esistenti</h2>
        <div class="card-container">
            <!-- Card Esempio 1 -->
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Taglio di capelli</h5>
                    <p class="card-text">Un taglio di capelli professionale per un look alla moda.</p>
                    <p class="card-text"><strong>Prezzo:</strong> €25.00</p>
                    <button type="button" class="btn btn-primary btn-edit" data-toggle="modal" data-target="#editPriceModal" data-service="Taglio di capelli" data-price="25.00">Modifica Prezzo</button>
                </div>
            </div>
            <!-- Card Esempio 2 -->
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Colore capelli</h5>
                    <p class="card-text">Colorazione professionale per dare vita ai tuoi capelli.</p>
                    <p class="card-text"><strong>Prezzo:</strong> €40.00</p>
                    <button type="button" class="btn btn-primary btn-edit" data-toggle="modal" data-target="#editPriceModal" data-service="Colore capelli" data-price="40.00">Modifica Prezzo</button>
                </div>
            </div>
            <!-- Card Esempio 3 -->
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Manicure</h5>
                    <p class="card-text">Manicure professionale per unghie perfette.</p>
                    <p class="card-text"><strong>Prezzo:</strong> €15.00</p>
                    <button type="button" class="btn btn-primary btn-edit" data-toggle="modal" data-target="#editPriceModal" data-service="Manicure" data-price="15.00">Modifica Prezzo</button>
                </div>
            </div>
            <!-- Aggiungi altre card qui -->
        </div>
    </div>
    
    <!-- Footer -->
	<footer th:replace="fragments/base.html :: footer"></footer>

    <!-- Modal per modificare il prezzo -->
    <div class="modal fade" id="editPriceModal" tabindex="-1" aria-labelledby="editPriceModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editPriceModalLabel">Modifica Prezzo</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editPriceForm">
                        <div class="form-group">
                            <label for="serviceName">Nome del Servizio</label>
                            <input type="text" class="form-control" id="serviceName" readonly>
                        </div>
                        <div class="form-group">
                            <label for="servicePrice">Prezzo</label>
                            <input type="number" class="form-control" id="servicePrice" step="0.01" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Salva Modifiche</button>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <!-- Bootstrap JS and dependencies (jQuery and Popper.js) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        $('#editPriceModal').on('show.bs.modal', function (event) {
            var button = $(event.relatedTarget); // Button that triggered the modal
            var service = button.data('service'); // Extract info from data-* attributes
            var price = button.data('price');

            var modal = $(this);
            modal.find('.modal-title').text('Modifica Prezzo per ' + service);
            modal.find('.modal-body #serviceName').val(service);
            modal.find('.modal-body #servicePrice').val(price);
        });

        $('#editPriceForm').on('submit', function (event) {
            event.preventDefault();
            var serviceName = $('#serviceName').val();
            var servicePrice = $('#servicePrice').val();
            // Qui puoi aggiungere il codice per salvare il nuovo prezzo nel database
            alert('Prezzo per ' + serviceName + ' aggiornato a €' + servicePrice);
            $('#editPriceModal').modal('hide');
        });
    </script>
</body>
</html>
